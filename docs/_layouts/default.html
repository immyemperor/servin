<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">

{%- include head.html -%}

<body>
  {%- include header.html -%}

  <div class="page-wrapper">
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
      <div class="sidebar-header">
        <h2>ðŸš€ Servin Runtime</h2>
        <p class="version">v1.0.0</p>
      </div>
      
      <div class="sidebar-search">
        <input type="text" id="search-input" placeholder="Search docs..." />
      </div>

      <div class="sidebar-nav">
        <div class="nav-section">
          <h4 class="nav-title">Overview</h4>
          <a href="{{ '/overview' | relative_url }}" class="nav-link">Project Overview</a>
          <a href="{{ '/architecture' | relative_url }}" class="nav-link">Architecture</a>
          <a href="{{ '/features' | relative_url }}" class="nav-link">Features</a>
        </div>

        <div class="nav-section">
          <h4 class="nav-title">Getting Started</h4>
          <a href="{{ '/installation' | relative_url }}" class="nav-link">Installation</a>
          <a href="{{ '/configuration' | relative_url }}" class="nav-link">Configuration</a>
        </div>

        <div class="nav-section">
          <h4 class="nav-title">User Interfaces</h4>
          <a href="{{ '/cli' | relative_url }}" class="nav-link">Command Line (CLI)</a>
          <a href="{{ '/tui' | relative_url }}" class="nav-link">Terminal UI (TUI)</a>
          <a href="{{ '/gui' | relative_url }}" class="nav-link">Desktop GUI</a>
        </div>

        <div class="nav-section">
          <h4 class="nav-title">Core Features</h4>
          <a href="{{ '/container-management' | relative_url }}" class="nav-link">Container Management</a>
          <a href="{{ '/image-management' | relative_url }}" class="nav-link">Image Management</a>
          <a href="{{ '/volume-management' | relative_url }}" class="nav-link">Volume Management</a>
          <a href="{{ '/registry-operations' | relative_url }}" class="nav-link">Registry Operations</a>
        </div>

        <div class="nav-section">
          <h4 class="nav-title">Integration</h4>
          <a href="{{ '/cri' | relative_url }}" class="nav-link">Kubernetes CRI</a>
          <a href="{{ '/api-reference' | relative_url }}" class="nav-link">API Reference</a>
          <a href="{{ '/logging-monitoring' | relative_url }}" class="nav-link">Logging & Monitoring</a>
        </div>

        <div class="nav-section">
          <h4 class="nav-title">Development</h4>
          <a href="{{ '/development' | relative_url }}" class="nav-link">Development Guide</a>
          <a href="{{ '/troubleshooting' | relative_url }}" class="nav-link">Troubleshooting</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {{ content }}
      </div>
    </main>
  </div>

  {%- include footer.html -%}

  <script>
    // Simple search functionality
    document.getElementById('search-input').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const navLinks = document.querySelectorAll('.nav-link');
      
      navLinks.forEach(link => {
        const text = link.textContent.toLowerCase();
        if (text.includes(searchTerm)) {
          link.style.display = 'block';
          link.parentElement.style.display = 'block';
        } else {
          link.style.display = 'none';
        }
      });
    });

    // Add active class to current page
    const currentPath = window.location.pathname;
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      if (link.getAttribute('href') === currentPath) {
        link.classList.add('active');
      }
    });

    // Code copy functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Add copy buttons to code blocks
      const codeBlocks = document.querySelectorAll('pre');
      
      codeBlocks.forEach(function(codeBlock) {
        // Skip if already has a copy button
        if (codeBlock.querySelector('.copy-button')) {
          return;
        }
        
        // Create copy button
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-button';
        copyButton.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>
          <span class="copy-text">Copy</span>
        `;
        
        // Position the copy button
        codeBlock.style.position = 'relative';
        copyButton.style.position = 'absolute';
        copyButton.style.top = '0.75rem';
        copyButton.style.right = '0.75rem';
        copyButton.style.background = 'rgba(0, 0, 0, 0.7)';
        copyButton.style.color = 'white';
        copyButton.style.border = 'none';
        copyButton.style.borderRadius = '6px';
        copyButton.style.padding = '0.5rem';
        copyButton.style.fontSize = '0.75rem';
        copyButton.style.cursor = 'pointer';
        copyButton.style.display = 'flex';
        copyButton.style.alignItems = 'center';
        copyButton.style.gap = '0.25rem';
        copyButton.style.opacity = '0';
        copyButton.style.transition = 'opacity 0.2s ease';
        copyButton.style.zIndex = '10';
        
        // Show/hide copy button on hover
        codeBlock.addEventListener('mouseenter', function() {
          copyButton.style.opacity = '1';
        });
        
        codeBlock.addEventListener('mouseleave', function() {
          copyButton.style.opacity = '0';
        });
        
        // Copy functionality
        copyButton.addEventListener('click', async function() {
          const code = codeBlock.querySelector('code');
          const text = code ? code.textContent : codeBlock.textContent;
          
          try {
            await navigator.clipboard.writeText(text);
            
            // Show success feedback
            const originalContent = copyButton.innerHTML;
            copyButton.innerHTML = `
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 6L9 17l-5-5"></path>
              </svg>
              <span class="copy-text">Copied!</span>
            `;
            copyButton.style.background = 'rgba(16, 185, 129, 0.8)';
            
            setTimeout(function() {
              copyButton.innerHTML = originalContent;
              copyButton.style.background = 'rgba(0, 0, 0, 0.7)';
            }, 2000);
            
          } catch (err) {
            console.error('Failed to copy code:', err);
          }
        });
        
        codeBlock.appendChild(copyButton);
      });
    });
  </script>
</body>

</html>
